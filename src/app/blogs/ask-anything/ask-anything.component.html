<div class="dark:bg-slate-900 min-h-screen selection:bg-sky-500/20 selection:text-sky-900 dark:selection:text-sky-100">
  <!-- Navbar -->
  <div *ngIf="!isLoggedIn"><app-navbar></app-navbar></div>
  <div *ngIf="isLoggedIn">
    <app-navbar
      [sideBarSmall]="true" [sideBarBig]="false"
      [email]="auth.currentUser?.email"
      [firstName]="auth.currentUser?.firstName"
      [lastName]="auth.currentUser?.lastName"
      [path]="'ask-anything'">
    </app-navbar>
  </div>

  <!-- Ambient blobs -->
  <div aria-hidden="true" class="pointer-events-none fixed inset-0 -z-10 overflow-hidden">
    <div class="absolute -top-32 -left-24 h-80 w-80 rounded-full bg-sky-400/25 blur-3xl"></div>
    <div class="absolute -bottom-28 -right-24 h-[28rem] w-[28rem] rounded-full bg-emerald-400/20 blur-3xl"></div>
  </div>

  <!-- Body -->
  <section class="bg-white/0 dark:bg-transparent mt-12">
    <div class="gap-16 items-center py-10 px-4 mx-auto max-w-screen-xl
                lg:grid lg:grid-cols-2 lg:py-16 lg:px-6">

      <!-- Left: Copy / Hero -->
      <div class="font-light text-gray-600 sm:text-lg dark:text-gray-300">
        <h1 class="mb-4 text-2xl md:text-3xl lg:text-5xl font-extrabold text-gray-900 dark:text-white">
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-sky-400 to-emerald-600">
            Ask Anything
          </span>
          — we’ll get back to you
        </h1>

        <p class="mb-6 text-gray-700 dark:text-gray-300">
          Ask a question about NewWorld Game, programs, pricing, partnerships, or anything else.
          If you’re signed in, we’ll use your profile info automatically.
        </p>

        <ul class="space-y-2 text-gray-700 dark:text-gray-300">
          <li class="flex items-start gap-3">
            <svg class="h-5 w-5 mt-1" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 6L9 17l-5-5"></path>
            </svg>
            Fast response by email
          </li>
          <li class="flex items-start gap-3">
            <svg class="h-5 w-5 mt-1" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 6L9 17l-5-5"></path>
            </svg>
            No spam—ever
          </li>
        </ul>
      </div>

      <!-- Right: Form Card -->
      <div class="grid grid-cols-1 gap-4 my-6">
        <!-- subtle gradient border wrapper -->
        <div class="rounded-3xl p-[1px] bg-gradient-to-br from-sky-400/30 via-cyan-400/20 to-emerald-400/30">
          <div class="w-full rounded-3xl bg-white/90 dark:bg-slate-900/80 ring-1 ring-black/5
                      shadow-lg backdrop-blur-md p-6 md:p-8">
                <!-- Success -->
                <div *ngIf="success"
                    class="mb-4 rounded-xl border border-emerald-200/60 bg-emerald-50 text-emerald-900
                            dark:border-emerald-700/50 dark:bg-emerald-900/20 dark:text-emerald-200 p-4">
                ✅ Thank you! We received your question and will reply by email.
                </div>

                <!-- Error -->
                <div *ngIf="submitError"
                    class="mb-4 rounded-xl border border-rose-200/60 bg-rose-50 text-rose-900
                            dark:border-rose-700/50 dark:bg-rose-900/20 dark:text-rose-200 p-4">
                ⚠️ An error occurred. Please try again.
                </div>


            <!-- Form -->
            <form [formGroup]="form" (ngSubmit)="submit()" novalidate class="space-y-4">

              <!-- Signed-out fields -->
              <div *ngIf="!isLoggedIn" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <!-- First name -->
                <div class="relative">
                  <label class="block text-sm font-medium text-slate-800 dark:text-slate-200 mb-1">First name</label>
                  <div class="relative">
                    <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
                      <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-3-3.87M4 21v-2a4 4 0 0 1 3-3.87M7 7a5 5 0 1 1 10 0 5 5 0 0 1-10 0z"/>
                      </svg>
                    </span>
                    <input type="text" formControlName="firstName"
                      class="w-full rounded-xl border border-slate-200/80 dark:border-slate-700/70
                             bg-white dark:bg-slate-800/80 px-3 py-2 pl-10
                             text-slate-900 dark:text-slate-100
                             placeholder-slate-400 dark:placeholder-slate-500
                             caret-sky-400 focus:outline-none focus:ring-2
                             focus:ring-sky-400/70 dark:focus:ring-sky-400/60 focus:border-transparent" 
                      placeholder="Jane"/>
                  </div>
                  <p *ngIf="submitted && form.controls.firstName.invalid"
                     class="mt-1 text-xs text-rose-600">First name is required.</p>
                </div>

                <!-- Last name -->
                <div class="relative">
                  <label class="block text-sm font-medium text-slate-800 dark:text-slate-200 mb-1">Last name</label>
                  <div class="relative">
                    <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
                      <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-3-3.87M4 21v-2a4 4 0 0 1 3-3.87M7 7a5 5 0 1 1 10 0 5 5 0 0 1-10 0z"/>
                      </svg>
                    </span>
                    <input type="text" formControlName="lastName"
                      class="w-full rounded-xl border border-slate-200/80 dark:border-slate-700/70
                             bg-white dark:bg-slate-800/80 px-3 py-2 pl-10
                             text-slate-900 dark:text-slate-100
                             placeholder-slate-400 dark:placeholder-slate-500
                             caret-sky-400 focus:outline-none focus:ring-2
                             focus:ring-sky-400/70 dark:focus:ring-sky-400/60 focus:border-transparent"
                      placeholder="Doe"/>
                  </div>
                  <p *ngIf="submitted && form.controls.lastName.invalid"
                     class="mt-1 text-xs text-rose-600">Last name is required.</p>
                </div>

                <!-- Email -->
                <div class="sm:col-span-2">
                  <label class="block text-sm font-medium text-slate-800 dark:text-slate-200 mb-1">Email</label>
                  <div class="relative">
                    <span class="pointer-events-none absolute inset-y-0 left-3 flex items-center">
                      <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M4 4h16v16H4z"/><path d="m22 6-10 7L2 6"/>
                      </svg>
                    </span>
                    <input type="email" formControlName="email"
                      class="w-full rounded-xl border border-slate-200/80 dark:border-slate-700/70
                             bg-white dark:bg-slate-800/80 px-3 py-2 pl-10
                             text-slate-900 dark:text-slate-100
                             placeholder-slate-400 dark:placeholder-slate-500
                             caret-sky-400 focus:outline-none focus:ring-2
                             focus:ring-sky-400/70 dark:focus:ring-sky-400/60 focus:border-transparent"
                      placeholder="you@school.edu"/>
                  </div>
                  <p *ngIf="submitted && form.controls.email.invalid"
                     class="mt-1 text-xs text-rose-600">Valid email is required.</p>
                </div>
              </div>

              <!-- Question (always visible) -->
              <div>
                <label class="block text-sm font-medium text-slate-800 dark:text-slate-200 mb-1">Your question</label>
                <div class="relative">
                  <span class="pointer-events-none absolute top-3 left-3">
                    <svg class="h-4 w-4 text-slate-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                      <path d="M9 9h6M9 13h3"/><path d="M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h7"/>
                    </svg>
                  </span>
                  <textarea formControlName="question" rows="6"
                    class="w-full min-h-[160px] rounded-2xl border border-slate-200/80 dark:border-slate-700/70
                           bg-white dark:bg-slate-800/80 px-3 py-3 pl-10
                           text-slate-900 dark:text-slate-100
                           placeholder-slate-400 dark:placeholder-slate-500
                           caret-sky-400 focus:outline-none focus:ring-2
                           focus:ring-sky-400/70 dark:focus:ring-sky-400/60 focus:border-transparent"
                    placeholder="Write your question here…"></textarea>
                </div>
                <div class="mt-1 flex items-center justify-between">
                    <p *ngIf="(form.controls.question.touched || submitted) && form.controls.question.invalid"
                    class="text-xs text-rose-600">
                    Please enter your question (min 10 characters).
                    </p>

                  <span class="text-xs text-slate-500 dark:text-slate-400 ml-auto">
                    {{ (form.controls.question.value?.length || 0) }} chars
                  </span>
                </div>
              </div>

              <!-- Submit -->
              <div class="pt-2">
                <button type="submit" [disabled]="loading"
                  class="inline-flex items-center justify-center gap-2 rounded-full px-6 py-3
                         text-white bg-gradient-to-r from-sky-500 to-emerald-500
                         hover:from-sky-600 hover:to-emerald-600
                         disabled:opacity-60 shadow-lg shadow-sky-500/20">
                  <svg *ngIf="loading" class="h-5 w-5 animate-spin" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" opacity="0.25"></circle>
                    <path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"></path>
                  </svg>
                  <span>{{ loading ? 'Sending…' : 'Send question' }}</span>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>

    </div>
  </section>

  <app-footer></app-footer>
</div>
